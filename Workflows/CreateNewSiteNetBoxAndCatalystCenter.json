{
  "workflow": {
    "unique_name": "definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq",
    "name": "Create a new Site in NetBox and Catalyst Center",
    "title": "Create a new Site in NetBox and Catalyst Center",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "variable_type_array_02RSBWYJCL4P70vBz8EMlSn6DdcoaaXdO5B",
        "properties": {
          "value": [],
          "scope": "local",
          "name": "List of Regions",
          "type": "datatype.array",
          "description": "Array of regions from NetBox for dropdown selection",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02RSCG59HFJ326gWPK6GVchOQNW1ip5ZubR",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "variable_type_array_02RSBWYJCL4P70vBz8EMlSn6DdcoaaXdO5B",
        "properties": {
          "value": [],
          "scope": "local",
          "name": "List of Tenants",
          "type": "datatype.array",
          "description": "Array of tenants from NetBox for dropdown selection",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02RSCFYHLRH1Y1Vcq2ydubOQkZsBtGpWB4y",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 1,
          "scope": "local",
          "name": "Number of Floors Int",
          "type": "datatype.integer",
          "description": "Number of floors converted to integer",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF4",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 1,
          "scope": "local",
          "name": "Lowest Floor Int",
          "type": "datatype.integer",
          "description": "Lowest floor number converted to integer",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF5",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "Master workflow to create a new site in both NetBox and Catalyst Center.\n\nWorkflow:\n1. Fetches tenants and regions from NetBox to populate dropdowns\n2. Prompts user for site information (Tenant, Region, Site Name, Address, Floors)\n3. Creates the site and floor locations in NetBox\n4. Creates the corresponding building and floors in Catalyst Center\n5. Updates NetBox status to active after successful creation\n\nPrerequisites:\n• Tenant area must already exist in Catalyst Center (e.g., Global/BRKOPS-2357)\n• Region areas must already exist in Catalyst Center (e.g., Global/BRKOPS-2357/EMEA)\n• Import GetDataFromNetBox.json atomic workflow first",
      "display_name": "Create a new Site in NetBox and Catalyst Center",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "no_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF1",
        "name": "Get Data from NetBox",
        "title": "Get All Tenants from NetBox",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Get All Tenants from NetBox",
          "input": {
            "variable_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxB": "api/tenancy/tenants/",
            "variable_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxC": ""
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target": true,
            "target_id": "definition_target_02RPUNI85LRRY0UogrmrEt4WeuzlLfBLXMC",
            "target_type": "netbox.endpoint"
          },
          "workflow_id": "definition_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxA",
          "workflow_name": "Get Data from NetBox"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF2",
        "name": "Get Data from NetBox",
        "title": "Get All Regions from NetBox",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Get All Regions from NetBox",
          "input": {
            "variable_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxB": "api/dcim/regions/",
            "variable_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxC": ""
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target": true,
            "target_id": "definition_target_02RPUNI85LRRY0UogrmrEt4WeuzlLfBLXMC",
            "target_type": "netbox.endpoint"
          },
          "workflow_id": "definition_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxA",
          "workflow_name": "Get Data from NetBox"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF3",
        "name": "Set Variables",
        "title": "Populate Dropdown Lists",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Populate Dropdown Lists",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.local.variable_workflow_02RSCFYHLRH1Y1Vcq2ydubOQkZsBtGpWB4y$",
              "variable_value_new": "$activity.definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF1.output.variable_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxD$"
            },
            {
              "variable_to_update": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.local.variable_workflow_02RSCG59HFJ326gWPK6GVchOQNW1ip5ZubR$",
              "variable_value_new": "$activity.definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF2.output.variable_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxD$"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02RSCCRQMWGAH1TiTaHaSb666ksmEbGdboT",
        "name": "Create Prompt",
        "title": "Collect Site Information",
        "type": "task.prompt_request",
        "base_type": "activity",
        "properties": {
          "assignee_roles": [
            "admin",
            "user"
          ],
          "assignees": [
            "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.output.started_by$"
          ],
          "continue_on_failure": false,
          "description": "Collect information to create a new site in NetBox and Catalyst Center",
          "display_name": "Collect Site Information",
          "expiration_date": {
            "is_relative_time": true,
            "relative_time": {
              "duration": 72,
              "time_units": "hours"
            }
          },
          "form_elements": [
            {
              "allow_multiselect": false,
              "form_element": "select",
              "form_label": "Tenant",
              "form_option_label_key": "name",
              "form_source_array": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.local.variable_workflow_02RSCFYHLRH1Y1Vcq2ydubOQkZsBtGpWB4y$"
            },
            {
              "allow_multiselect": false,
              "form_element": "select",
              "form_label": "Region",
              "form_option_label_key": "name",
              "form_source_array": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.local.variable_workflow_02RSCG59HFJ326gWPK6GVchOQNW1ip5ZubR$"
            },
            {
              "allow_multiselect": false,
              "form_element": "text",
              "form_label": "Site Name",
              "form_option_label_key": ""
            },
            {
              "allow_multiselect": false,
              "form_element": "text",
              "form_label": "Address",
              "form_option_label_key": ""
            },
            {
              "allow_multiselect": false,
              "form_element": "text",
              "form_label": "Number of Floors",
              "form_option_label_key": ""
            },
            {
              "allow_multiselect": false,
              "form_element": "text",
              "form_label": "Lowest Floor",
              "form_option_label_key": ""
            }
          ],
          "prompt_body": "Please provide the following information to create a new site:\n\n• **Tenant**: Select the NetBox tenant for the site\n• **Region**: Select the geographic region (must exist in Catalyst Center)\n• **Site Name**: Name for the new site/building\n• **Address**: Physical address (used for GPS coordinates via Google Maps)\n• **Number of Floors**: Total number of floors to create\n• **Lowest Floor**: Starting floor number (e.g., 1 or -1 for basement)",
          "prompt_title": "New Site Information",
          "skip_execution": false,
          "task_owner": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.output.started_by$",
          "task_requestor": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.output.started_by$",
          "wait_for_prompt_response": true
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF6",
        "name": "Execute Python Script",
        "title": "Convert Floor Values to Integers",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Convert Floor Values to Integers",
          "script": "import sys\n\n# Get string values from prompt\nnum_floors_str = sys.argv[1]\nlowest_floor_str = sys.argv[2]\n\n# Convert to integers with error handling\ntry:\n    num_floors = int(num_floors_str)\nexcept (ValueError, TypeError):\n    num_floors = 1  # Default to 1 floor\n\ntry:\n    lowest_floor = int(lowest_floor_str)\nexcept (ValueError, TypeError):\n    lowest_floor = 1  # Default to floor 1\n\nprint(f\"Number of Floors: {num_floors}, Lowest Floor: {lowest_floor}\")",
          "script_arguments": [
            "$activity.definition_activity_02RSCCRQMWGAH1TiTaHaSb666ksmEbGdboT.output.prompt_response.Number of Floors$",
            "$activity.definition_activity_02RSCCRQMWGAH1TiTaHaSb666ksmEbGdboT.output.prompt_response.Lowest Floor$"
          ],
          "script_queries": [
            {
              "script_query": "num_floors",
              "script_query_name": "num_floors_int",
              "script_query_type": "integer"
            },
            {
              "script_query": "lowest_floor",
              "script_query_name": "lowest_floor_int",
              "script_query_type": "integer"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF7",
        "name": "Set Variables",
        "title": "Store Converted Integer Values",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Store Converted Integer Values",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.local.variable_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF4$",
              "variable_value_new": "$activity.definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF6.output.script_queries.num_floors_int$"
            },
            {
              "variable_to_update": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.local.variable_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF5$",
              "variable_value_new": "$activity.definition_activity_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF6.output.script_queries.lowest_floor_int$"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02RSCC78ZHL5I2ZzrucoeDENqCl2eZT1q9Q",
        "name": "Create Site & Locations in NetBox",
        "title": "Create Site & Locations in NetBox",
        "type": "workflow.sub_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "description": "Creates the site and floor locations in NetBox",
          "display_name": "Create Site & Locations in NetBox",
          "input": {
            "variable_workflow_02RRHZJIVFCOF1LHPAfMUhTZy2fFBUi0v3f": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.local.variable_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF5$",
            "variable_workflow_02RRHZJIVFN8V1eGP02ouMKqltHFMiGyx85": "$activity.definition_activity_02RSCCRQMWGAH1TiTaHaSb666ksmEbGdboT.output.prompt_response.Tenant.name$",
            "variable_workflow_02RRHZJIVFTL00VYGHuCWOlNag65Uxro5wc": "$activity.definition_activity_02RSCCRQMWGAH1TiTaHaSb666ksmEbGdboT.output.prompt_response.Region.name$",
            "variable_workflow_02RRHZJIVG3YT28W4luAC18vLr1Qm3kKnKL": "$activity.definition_activity_02RSCCRQMWGAH1TiTaHaSb666ksmEbGdboT.output.prompt_response.Site Name$",
            "variable_workflow_02RRHZJIVGBYZ3HxagYVYoXNmX4LFe9EQ0h": "$workflow.definition_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMEq.local.variable_workflow_02RSCC208AVQU7Tromo2wiG2Knwnee0VMF4$",
            "variable_workflow_02RRHZJIVGNRH0Uzdbewr4sTeih97hjX83b": "$activity.definition_activity_02RSCCRQMWGAH1TiTaHaSb666ksmEbGdboT.output.prompt_response.Address$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "no_target": true
          },
          "workflow_id": "definition_workflow_02RRHT296T3YE6HKuGnc8FqZCcAwBUqQtfL",
          "workflow_name": "Create Site & Locations in NetBox"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02RSCC9Z3VGST3epWipzvIFvoU4u5chJSZa",
        "name": "Create Site Hierarchy in Catalyst Center from NetBox",
        "title": "Create Site Hierarchy in Catalyst Center from NetBox",
        "type": "workflow.sub_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "description": "Creates the building and floors in Catalyst Center based on the NetBox data",
          "display_name": "Create Site Hierarchy in Catalyst Center from NetBox",
          "input": {
            "variable_workflow_02RRPOMCWOSPW0aR0mLzeLT2JLlJhHbiM9T": "$activity.definition_activity_02RSCCRQMWGAH1TiTaHaSb666ksmEbGdboT.output.prompt_response.Tenant.name$",
            "variable_workflow_02RRPOMCWOSPW0aR0mLzeLT2JLlJhHbiM9U": "planned"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "no_target": true
          },
          "workflow_id": "definition_workflow_02RRPOMCWOSPW0aR0mLzeLT2JLlJhHbiM9S",
          "workflow_name": "Create Site Hierarchy in Catalyst Center from NetBox"
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_02RRO197QIU1N4lnnTBXQ9QbmLLZtDXEIRN"
    ]
  },
  "categories": {
    "category_02RRO197QIU1N4lnnTBXQ9QbmLLZtDXEIRN": {
      "unique_name": "category_02RRO197QIU1N4lnnTBXQ9QbmLLZtDXEIRN",
      "name": "BRKOPS-2357",
      "title": "BRKOPS-2357",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "targets": {
    "definition_target_02RPUNI85LRRY0UogrmrEt4WeuzlLfBLXMC": {
      "unique_name": "definition_target_02RPUNI85LRRY0UogrmrEt4WeuzlLfBLXMC",
      "name": "NetBox",
      "title": "NetBox",
      "type": "netbox.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "_host": "192.168.99.93",
        "_port": 443,
        "_protocol": "https",
        "_tls_insecure": true,
        "ao_remote_id": "02PZPDMADVCHW17LBkiPU0VlP2JnyMUqY0D",
        "default_runtime_user_id": "definition_runtime_user_02Q33243345V15wqObawPAHY80bzrWVm6V9",
        "display_name": "NetBox",
        "ignore_proxy": false,
        "is_https_proxy": false
      }
    }
  },
  "runtime_users": {
    "definition_runtime_user_02Q33243345V15wqObawPAHY80bzrWVm6V9": {
      "unique_name": "definition_runtime_user_02Q33243345V15wqObawPAHY80bzrWVm6V9",
      "name": "NetBox",
      "title": "NetBox",
      "type": "runtime_user.netbox_token_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "_token": "*****",
        "display_name": "NetBox"
      }
    }
  },
  "variable_types": {
    "variable_type_array_02RSBWYJCL4P70vBz8EMlSn6DdcoaaXdO5B": {
      "base_type": "datatype",
      "name": "GenericMapArray",
      "object_type": "variable_type_array",
      "properties": {
        "display_name": "GenericMapArray",
        "elements_type_id": "variable_type_object_02RS9UB9BN3FO0xpXdKJXwWLNspyklvYJa7"
      },
      "title": "GenericMapArray",
      "type": "datatype.arraytype",
      "unique_name": "variable_type_array_02RSBWYJCL4P70vBz8EMlSn6DdcoaaXdO5B",
      "variable_type_schema_id": "variable_type_schema_array_02RSBWYJ9XMBM0gdSvYsYhQkU4yx4R37swj"
    },
    "variable_type_object_02RS9UB9BN3FO0xpXdKJXwWLNspyklvYJa7": {
      "base_type": "datatype",
      "description": "generic map, item of id, name",
      "name": "GenericMapItem",
      "object_type": "variable_type_object",
      "properties": {
        "display_name": "GenericMapItem"
      },
      "title": "GenericMapItem",
      "type": "datatype.objecttype",
      "unique_name": "variable_type_object_02RS9UB9BN3FO0xpXdKJXwWLNspyklvYJa7",
      "variable_type_schema_id": "variable_type_schema_object_02RS9UB994C7B6WfUWzjog3kf6HgnXUIw6B",
      "keys": [
        {
          "name": "id",
          "type": "string"
        },
        {
          "name": "name",
          "type": "string"
        }
      ]
    }
  },
  "atomic_workflows": [
    "definition_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxA"
  ],
  "remotemetas": {
    "remote_meta_02PZPDMARJFXL4cljmxILTXsdTRNhbPF9Nh": {
      "base_type": "remote_meta",
      "type": "generic.remote_meta",
      "name": "remote-wlsn-01",
      "title": "remote-wlsn-01",
      "version": "1.0.0",
      "properties": {
        "advanced": {
          "require_advanced": false
        },
        "cloud_type": "vmware",
        "display_name": "remote-wlsn-01",
        "network": {
          "dns_servers": "192.168.99.101,192.168.99.102",
          "gateway": "192.168.99.1",
          "ip_endpoint": "192.168.99.21/24",
          "is_static_ip": true
        },
        "proxy": {
          "require_proxy": false
        }
      },
      "unique_name": "remote_meta_02PZPDMARJFXL4cljmxILTXsdTRNhbPF9Nh",
      "object_type": "remote_meta"
    }
  },
  "dependent_workflows": [
    "definition_workflow_02RRTABC40TUC0oWGXLkN1TmA8lXoe3RBxA",
    "definition_workflow_02RRHT296T3YE6HKuGnc8FqZCcAwBUqQtfL",
    "definition_workflow_02RRPOMCWOSPW0aR0mLzeLT2JLlJhHbiM9S"
  ]
}
